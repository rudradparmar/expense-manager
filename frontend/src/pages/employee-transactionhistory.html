<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transactions - CyberCorp</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Custom styles for the cyberpunk theme */
      :root {
        --cyber-black: #0a0a0a;
        --cyber-dark: #111;
        --cyber-gray: #1a1a1a;
        --cyber-light-gray: #374151;
        --neon-blue: #00f0ff;
        --neon-purple: #8b5cf6;
        --neon-pink: #ec4899;
        --neon-green: #10b981;
        --neon-orange: #f59e0b;
        --text-primary: #e0e0e0;
        --text-secondary: #9ca3af;
      }

      html {
        box-sizing: border-box;
      }
      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: var(--cyber-black);
        color: var(--text-primary);
        margin: 0;
        display: flex;
        height: 100vh;
        overflow: hidden;
      }

      .font-cyber {
        font-family: "Orbitron", sans-serif;
      }

      .glow-text {
        color: #fff;
        text-shadow: 0 0 5px var(--neon-blue), 0 0 10px var(--neon-blue),
          0 0 20px var(--neon-blue);
      }

      /* Page Layout */
      .sidebar {
        width: 280px;
        background-color: var(--cyber-dark);
        border-right: 1px solid rgba(0, 240, 255, 0.2);
        display: flex;
        flex-direction: column;
        flex-shrink: 0;
      }

      .main-content {
        flex: 1;
        overflow-y: auto;
        padding: 2rem;
      }

      /* Sidebar Styles */
      .sidebar-header {
        padding: 1.5rem;
        border-bottom: 1px solid rgba(0, 240, 255, 0.2);
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .sidebar-header .logo-icon {
        width: 2.5rem;
        height: 2.5rem;
        background-image: linear-gradient(
          to right,
          var(--neon-blue),
          var(--neon-purple)
        );
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .sidebar-header .logo-text h1 {
        font-size: 1.25rem;
        margin: 0;
        line-height: 1.2;
      }
      .sidebar-header .logo-text p {
        font-size: 0.75rem;
        color: var(--text-secondary);
        margin: 0;
      }

      .user-profile {
        padding: 1rem;
        border-bottom: 1px solid rgba(0, 240, 255, 0.2);
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .user-profile img {
        width: 3rem;
        height: 3rem;
        border-radius: 9999px;
        border: 2px solid rgba(0, 240, 255, 0.3);
        object-fit: cover;
      }
      .user-profile .user-info {
        overflow: hidden;
      }
      .user-profile .user-info h3 {
        margin: 0;
        font-size: 1rem;
        font-weight: 600;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .user-profile .user-info p {
        margin: 0;
        font-size: 0.75rem;
        color: var(--text-secondary);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .sidebar nav {
        flex: 1;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .nav-link {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 1rem;
        border-radius: 0.75rem;
        text-decoration: none;
        color: var(--text-secondary);
        font-weight: 500;
        transition: all 0.3s ease;
        position: relative;
      }
      .nav-link:hover {
        color: white;
        background-color: rgba(26, 26, 26, 0.5);
        transform: translateX(10px);
      }
      .nav-link.active {
        color: white;
        background-image: linear-gradient(
          to right,
          var(--from-color),
          var(--to-color)
        );
        box-shadow: 0 0 15px var(--from-color);
      }
      .user-actions {
        padding: 1rem;
        border-top: 1px solid rgba(0, 240, 255, 0.2);
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      .action-button {
        width: 100%;
        background: none;
        border: none;
        color: var(--text-secondary);
        font: inherit;
        cursor: pointer;
        text-align: left;
      }
      .action-button.logout {
        color: var(--neon-orange);
      }
      .action-button.logout:hover {
        background-color: rgba(245, 158, 11, 0.2);
      }

      /* Main Content General */
      .page-container {
        max-width: 1200px;
        margin: auto;
        display: grid;
        gap: 2rem;
      }

      .page-header {
        text-align: center;
      }
      .page-header h1 {
        font-size: 2.25rem;
        margin: 0 0 0.5rem 0;
      }
      .page-header .subtitle {
        color: var(--text-secondary);
      }

      .cyber-card {
        background-color: rgba(26, 26, 26, 0.8);
        border: 1px solid var(--cyber-light-gray);
        box-shadow: 0 0 15px rgba(0, 240, 255, 0.1);
        padding: 1.5rem;
        border-radius: 0.75rem;
      }

      /* Filter Section */
      .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }
      .filter-grid input,
      .filter-grid select {
        width: 100%;
        padding: 0.75rem 1rem;
        background-color: var(--cyber-gray);
        border: 1px solid var(--cyber-light-gray);
        border-radius: 0.5rem;
        color: var(--text-primary);
        transition: all 0.3s ease;
      }
      .filter-grid input:focus,
      .filter-grid select:focus {
        outline: none;
        border-color: var(--neon-blue);
        box-shadow: 0 0 10px rgba(0, 240, 255, 0.3);
      }
      .search-input {
        position: relative;
      }
      .search-input svg {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--neon-blue);
      }
      .search-input input {
        padding-left: 2.5rem;
      }
      .sort-controls {
        display: flex;
        gap: 0.5rem;
      }
      .sort-controls select {
        flex: 1;
      }
      .sort-controls button {
        padding: 0 0.75rem;
        background-color: var(--cyber-gray);
        border: 1px solid var(--cyber-light-gray);
        border-radius: 0.5rem;
        color: var(--neon-blue);
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .sort-controls button:hover {
        background-color: var(--neon-blue);
        color: var(--cyber-dark);
      }

      /* Transactions List */
      .transactions-list {
        display: grid;
        gap: 1rem;
      }
      .transaction-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        flex-wrap: wrap;
      }
      .transaction-details {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex: 1;
        min-width: 250px;
      }
      .transaction-icon {
        width: 3rem;
        height: 3rem;
        border-radius: 9999px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }
      .transaction-icon.income {
        background-image: linear-gradient(
          to right,
          var(--neon-green),
          var(--neon-blue)
        );
      }
      .transaction-icon.expense {
        background-image: linear-gradient(
          to right,
          var(--neon-orange),
          var(--neon-pink)
        );
      }
      .transaction-info .description {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .transaction-info .meta {
        display: flex;
        gap: 1rem;
        font-size: 0.875rem;
        color: var(--text-secondary);
      }
      .meta-item {
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }

      .transaction-right {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }
      .transaction-amount {
        font-family: "Orbitron", sans-serif;
        font-size: 1.25rem;
        font-weight: 700;
      }
      .transaction-amount.income {
        color: var(--neon-green);
        text-shadow: 0 0 8px var(--neon-green);
      }
      .transaction-amount.expense {
        color: var(--neon-orange);
        text-shadow: 0 0 8px var(--neon-orange);
      }

      .transaction-actions button {
        background: none;
        border: none;
        padding: 0.5rem;
        border-radius: 0.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .transaction-actions .edit-btn {
        color: var(--neon-blue);
      }
      .transaction-actions .edit-btn:hover {
        background-color: rgba(0, 240, 255, 0.1);
      }
      .transaction-actions .delete-btn {
        color: var(--neon-orange);
      }
      .transaction-actions .delete-btn:hover {
        background-color: rgba(245, 158, 11, 0.1);
      }

      /* Edit Form */
      .edit-form {
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--cyber-light-gray);
        display: none; /* Initially hidden */
      }
      .edit-form.active {
        display: block;
      }
      .edit-form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
      }
      .edit-form input {
        width: 100%;
        padding: 0.75rem 1rem;
        background-color: var(--cyber-gray);
        border: 1px solid var(--cyber-light-gray);
        border-radius: 0.5rem;
        color: var(--text-primary);
      }
      .edit-form-actions {
        margin-top: 1rem;
        display: flex;
        gap: 0.5rem;
      }
      .edit-form-actions button {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
      }
      .save-btn {
        background-color: var(--neon-blue);
        color: var(--cyber-dark);
      }
      .cancel-btn {
        background-color: var(--cyber-light-gray);
        color: var(--text-primary);
      }

      /* Summary & No-results */
      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        text-align: center;
      }
      .summary-grid .label {
        color: var(--text-secondary);
        margin-bottom: 0.25rem;
      }
      .summary-grid .value {
        font-size: 1.5rem;
        font-weight: 700;
      }
      .no-transactions {
        text-align: center;
        padding: 3rem 0;
        color: var(--text-secondary);
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fade-in-up {
        animation: fadeInUp 0.5s ease-out forwards;
        opacity: 0;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <aside class="sidebar">
      <!-- Header -->
      <div class="sidebar-header">
        <div class="logo-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#fff"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
          </svg>
        </div>
        <div class="logo-text">
          <h1 class="font-cyber glow-text">EXPENSE TRACKER</h1>
          <p>FUTURISTIC FINANCE</p>
        </div>
      </div>

      <!-- User Profile -->
      <div class="user-profile">
        <img
          src="https://api.dicebear.com/7.x/avataaars/svg?seed=Alex"
          alt="User Avatar"
        />
        <div class="user-info">
          <h3>Alex Ryder</h3>
          <p>alex.ryder@cybercorp.io</p>
        </div>
      </div>

      <!-- Navigation -->
      <nav>
        <a
          href="dashboard.html"
          class="nav-link"
          style="--from-color: var(--neon-blue); --to-color: var(--neon-purple)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          <span>Dashboard</span>
        </a>
        <a
          href="#"
          class="nav-link"
          style="--from-color: var(--neon-green); --to-color: var(--neon-blue)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M5 12h14"></path>
            <path d="M12 5v14"></path>
          </svg>
          <span>Add Transaction</span>
        </a>
        <a
          href="#"
          class="nav-link active"
          style="--from-color: var(--neon-purple); --to-color: var(--neon-pink)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="8" x2="21" y1="6" y2="6"></line>
            <line x1="8" x2="21" y1="12" y2="12"></line>
            <line x1="8" x2="21" y1="18" y2="18"></line>
            <line x1="3" x2="3.01" y1="6" y2="6"></line>
            <line x1="3" x2="3.01" y1="12" y2="12"></line>
            <line x1="3" x2="3.01" y1="18" y2="18"></line>
          </svg>
          <span>Transactions</span>
        </a>
        <a
          href="#"
          class="nav-link"
          style="--from-color: var(--neon-orange); --to-color: var(--neon-pink)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
            <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
          </svg>
          <span>Budget & Insights</span>
        </a>
        <a
          href="#"
          class="nav-link"
          style="--from-color: var(--neon-blue); --to-color: var(--neon-green)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <polyline points="9 11 12 14 22 4"></polyline>
            <path
              d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"
            ></path>
          </svg>
          <span>Approval Status</span>
        </a>
      </nav>

      <!-- User Actions -->
      <div class="user-actions">
        <a href="#" class="nav-link action-button">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span>Profile</span>
        </a>
        <button class="nav-link action-button">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="3"></circle>
            <path
              d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
            ></path>
          </svg>
          <span>Settings</span>
        </button>
        <button class="nav-link action-button logout">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" x2="9" y1="12" y2="12"></line>
          </svg>
          <span>Logout</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-container">
        <!-- Header -->
        <header class="page-header animate-fade-in-up">
          <h1 class="font-cyber glow-text">TRANSACTIONS</h1>
          <p class="subtitle">
            View and manage all your financial transactions
          </p>
        </header>

        <!-- Filters and Search -->
        <section
          class="cyber-card animate-fade-in-up"
          style="animation-delay: 0.1s"
        >
          <div class="filter-grid">
            <div class="search-input">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
              <input
                type="text"
                id="search-term"
                placeholder="Search transactions..."
              />
            </div>
            <select id="filter-type">
              <option value="all">All Types</option>
              <option value="income">Income</option>
              <option value="expense">Expense</option>
            </select>
            <select id="filter-category">
              <option value="all">All Categories</option>
              <!-- Categories will be populated by JS -->
            </select>
            <div class="sort-controls">
              <select id="sort-by">
                <option value="date">Date</option>
                <option value="amount">Amount</option>
                <option value="category">Category</option>
              </select>
              <button id="sort-order-btn">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M3 4h18M3 8h18M3 12h18M3 16h18M3 20h18" />
                </svg>
              </button>
            </div>
          </div>
        </section>

        <!-- Transactions List -->
        <section id="transactions-list-container" class="transactions-list">
          <!-- Transactions will be populated by JS -->
        </section>

        <!-- Summary -->
        <section
          class="cyber-card summary-section animate-fade-in-up"
          style="animation-delay: 0.2s"
        >
          <div class="summary-grid">
            <div>
              <p class="label">Total Transactions</p>
              <p id="total-transactions" class="value">0</p>
            </div>
            <div>
              <p class="label">Filtered Income</p>
              <p id="filtered-income" class="value text-neon-green">â‚¹0</p>
            </div>
            <div>
              <p class="label">Filtered Expenses</p>
              <p id="filtered-expenses" class="value text-neon-orange">â‚¹0</p>
            </div>
          </div>
        </section>
      </div>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // --- MOCK DATA ---
        let transactions = [
          {
            id: 1,
            type: "income",
            description: "Salary",
            category: "Salary",
            amount: 50000,
            date: "2025-10-01",
          },
          {
            id: 2,
            type: "expense",
            description: "Rent",
            category: "Bills",
            amount: 15000,
            date: "2025-10-02",
          },
          {
            id: 3,
            type: "expense",
            description: "Groceries",
            category: "Food & Dining",
            amount: 3500,
            date: "2025-10-02",
          },
          {
            id: 4,
            type: "expense",
            description: "Movie Night",
            category: "Entertainment",
            amount: 1200,
            date: "2025-09-28",
          },
          {
            id: 5,
            type: "income",
            description: "Freelance Project",
            category: "Freelance",
            amount: 8000,
            date: "2025-09-25",
          },
          {
            id: 6,
            type: "expense",
            description: "Gasoline",
            category: "Transportation",
            amount: 2000,
            date: "2025-09-24",
          },
          {
            id: 7,
            type: "expense",
            description: "New Keyboard",
            category: "Shopping",
            amount: 4500,
            date: "2025-09-22",
          },
        ];

        // --- STATE VARIABLES ---
        let searchTerm = "";
        let filterType = "all";
        let filterCategory = "all";
        let sortBy = "date";
        let sortOrder = "desc";
        let editingId = null;

        // --- DOM ELEMENTS ---
        const searchInput = document.getElementById("search-term");
        const typeFilter = document.getElementById("filter-type");
        const categoryFilter = document.getElementById("filter-category");
        const sortBySelect = document.getElementById("sort-by");
        const sortOrderBtn = document.getElementById("sort-order-btn");
        const listContainer = document.getElementById(
          "transactions-list-container"
        );
        const totalTransactionsEl =
          document.getElementById("total-transactions");
        const filteredIncomeEl = document.getElementById("filtered-income");
        const filteredExpensesEl = document.getElementById("filtered-expenses");

        // --- HELPER FUNCTIONS ---
        const formatDate = (dateString) =>
          new Date(dateString).toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });

        const getCategoryIcon = (category) => {
          const iconMap = {
            "Food & Dining": "ðŸ½ï¸",
            Transportation: "ðŸš—",
            Shopping: "ðŸ›ï¸",
            Entertainment: "ðŸŽ¬",
            Bills: "ðŸ“„",
            Salary: "ðŸ’°",
            Freelance: "ðŸ’¼",
          };
          return iconMap[category] || "ðŸ“Š";
        };

        // --- RENDER & UPDATE FUNCTIONS ---
        function renderTransactions() {
          // 1. Filter
          let filtered = transactions.filter((t) => {
            const matchesSearch =
              t.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
              t.category.toLowerCase().includes(searchTerm.toLowerCase());
            const matchesType = filterType === "all" || t.type === filterType;
            const matchesCategory =
              filterCategory === "all" || t.category === filterCategory;
            return matchesSearch && matchesType && matchesCategory;
          });

          // 2. Sort
          filtered.sort((a, b) => {
            let aValue, bValue;
            if (sortBy === "amount") {
              aValue = a.amount;
              bValue = b.amount;
            } else if (sortBy === "category") {
              aValue = a.category;
              bValue = b.category;
            } else {
              aValue = new Date(a.date);
              bValue = new Date(b.date);
            }

            if (sortOrder === "asc") return aValue > bValue ? 1 : -1;
            return aValue < bValue ? 1 : -1;
          });

          // 3. Render HTML
          listContainer.innerHTML = "";
          if (filtered.length === 0) {
            listContainer.innerHTML = `<div class="no-transactions"><h3>No transactions found</h3><p>Try adjusting your filters.</p></div>`;
          } else {
            filtered.forEach((t) => {
              const itemEl = document.createElement("div");
              itemEl.className = "cyber-card transaction-item";
              itemEl.innerHTML = `
                            <div class="transaction-details">
                                <div class="transaction-icon ${t.type}">
                                    ${
                                      t.type === "income"
                                        ? '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>'
                                        : '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline><polyline points="17 18 23 18 23 12"></polyline></svg>'
                                    }
                                </div>
                                <div class="transaction-info">
                                    <div class="description">${
                                      t.description
                                    } <span>${getCategoryIcon(
                t.category
              )}</span></div>
                                    <div class="meta">
                                        <span class="meta-item">${formatDate(
                                          t.date
                                        )}</span>
                                        <span class="meta-item">${
                                          t.category
                                        }</span>
                                    </div>
                                </div>
                            </div>
                            <div class="transaction-right">
                                <span class="transaction-amount ${t.type}">${
                t.type === "income" ? "+" : "-"
              }â‚¹${t.amount.toLocaleString()}</span>
                                <div class="transaction-actions">
                                    <button class="edit-btn" data-id="${
                                      t.id
                                    }"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg></button>
                                    <button class="delete-btn" data-id="${
                                      t.id
                                    }"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button>
                                </div>
                            </div>
                             <div class="edit-form" id="edit-form-${t.id}">
                                <div class="edit-form-grid">
                                    <input type="text" value="${
                                      t.description
                                    }" id="edit-desc-${t.id}">
                                    <input type="number" value="${
                                      t.amount
                                    }" id="edit-amount-${t.id}">
                                    <input type="date" value="${
                                      t.date
                                    }" id="edit-date-${t.id}">
                                </div>
                                <div class="edit-form-actions">
                                    <button class="save-btn" data-id="${
                                      t.id
                                    }">Save</button>
                                    <button class="cancel-btn" data-id="${
                                      t.id
                                    }">Cancel</button>
                                </div>
                            </div>
                        `;
              listContainer.appendChild(itemEl);
            });
          }
          updateSummary(filtered);
        }

        function updateSummary(filtered) {
          totalTransactionsEl.textContent = filtered.length;
          const income = filtered
            .filter((t) => t.type === "income")
            .reduce((sum, t) => sum + t.amount, 0);
          const expenses = filtered
            .filter((t) => t.type === "expense")
            .reduce((sum, t) => sum + t.amount, 0);
          filteredIncomeEl.textContent = `â‚¹${income.toLocaleString()}`;
          filteredExpensesEl.textContent = `â‚¹${expenses.toLocaleString()}`;
        }

        function populateCategories() {
          const uniqueCategories = [
            ...new Set(transactions.map((t) => t.category)),
          ];
          categoryFilter.innerHTML =
            '<option value="all">All Categories</option>';
          uniqueCategories.forEach((cat) => {
            const option = document.createElement("option");
            option.value = cat;
            option.textContent = cat;
            categoryFilter.appendChild(option);
          });
        }

        // --- EVENT HANDLERS ---
        listContainer.addEventListener("click", function (e) {
          const target = e.target.closest("button");
          if (!target) return;

          const id = parseInt(target.dataset.id);

          if (target.classList.contains("delete-btn")) {
            if (confirm("Are you sure you want to delete this transaction?")) {
              transactions = transactions.filter((t) => t.id !== id);
              renderTransactions();
            }
          }

          if (target.classList.contains("edit-btn")) {
            editingId = id;
            document
              .querySelectorAll(".edit-form")
              .forEach((f) => f.classList.remove("active"));
            document.getElementById(`edit-form-${id}`).classList.add("active");
          }

          if (target.classList.contains("cancel-btn")) {
            editingId = null;
            document
              .getElementById(`edit-form-${id}`)
              .classList.remove("active");
          }

          if (target.classList.contains("save-btn")) {
            const newDesc = document.getElementById(`edit-desc-${id}`).value;
            const newAmount = parseFloat(
              document.getElementById(`edit-amount-${id}`).value
            );
            const newDate = document.getElementById(`edit-date-${id}`).value;

            transactions = transactions.map((t) => {
              if (t.id === id) {
                return {
                  ...t,
                  description: newDesc,
                  amount: newAmount,
                  date: newDate,
                };
              }
              return t;
            });

            editingId = null;
            renderTransactions();
          }
        });

        // --- INITIALIZATION ---
        function init() {
          searchInput.addEventListener("input", (e) => {
            searchTerm = e.target.value;
            renderTransactions();
          });
          typeFilter.addEventListener("change", (e) => {
            filterType = e.target.value;
            renderTransactions();
          });
          categoryFilter.addEventListener("change", (e) => {
            filterCategory = e.target.value;
            renderTransactions();
          });
          sortBySelect.addEventListener("change", (e) => {
            sortBy = e.target.value;
            renderTransactions();
          });
          sortOrderBtn.addEventListener("click", () => {
            sortOrder = sortOrder === "asc" ? "desc" : "asc";
            sortOrderBtn.innerHTML =
              sortOrder === "asc"
                ? '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 4h18M3 8h18M3 12h18M3 16h18M3 20h18"/></svg>'
                : '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 4h18M3 8h18M3 12h18M3 16h18M3 20h18"/></svg>';
            renderTransactions();
          });

          populateCategories();
          renderTransactions();
        }

        init();
      });
    </script>
  </body>
</html>
